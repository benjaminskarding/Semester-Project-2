import{o as p,i as h,c as b}from"./conditionallyDisplay-Cby9GP4M.js";import{c as y,e as w,d as x}from"./displayCredits-DmSZQ3LS.js";import{a as u}from"./render-Bo-IY9pm.js";import"./headers-Dr2M59D8.js";function L(){const e=document.getElementById("logoutBtn");e&&e.addEventListener("click",p)}function v(e,s,o,t){const i=document.getElementById("pagination");if(!i){console.error("Pagination container not found!");return}i.innerHTML="";const r=Math.ceil(s/o),a=6;if(r===0){i.style.display="none";return}i.style.display="flex";const m=Math.max(Math.min(e-Math.floor(a/2),r-a+1),1),f=Math.min(m+a-1,r);for(let n=m;n<=f;n++){const c=document.createElement("button");c.textContent=n,c.className=n===e?"bg-yellow-400 text-black px-4 py-2 rounded":"bg-gray-700 text-white px-4 py-2 rounded hover:bg-gray-600",c.addEventListener("click",()=>{t(n)}),i.appendChild(c)}if(e>1){const n=document.createElement("button");n.textContent="Previous",n.className="bg-gray-700 text-white px-4 py-2 rounded hover:bg-gray-600",n.addEventListener("click",()=>{t(e-1)}),i.insertBefore(n,i.firstChild)}if(e<r){const n=document.createElement("button");n.textContent="Next",n.className="bg-gray-700 text-white px-4 py-2 rounded hover:bg-gray-600",n.addEventListener("click",()=>{t(e+1)}),i.appendChild(n)}}function E(){const e=document.getElementById("credits-section"),s=document.querySelector(".search-field"),o=document.querySelector("aside");h()?(e.style.display="block",e.parentNode.insertBefore(s,e.nextSibling)):(e.style.display="none",o.insertBefore(s,o.firstChild),s.classList.remove("mt-6"),s.classList.add("mt-0"));const t=s.querySelector("input");if(!t){console.error("Search input not found inside searchField.");return}t.addEventListener("input",async i=>{const r=i.target.value.trim();if(r===""){const{listings:a}=await y();u(a)}else{const a=await w(r);u(a)}})}function B(e,s){return e.sort((o,t)=>{switch(s){case"created_desc":return new Date(t.created)-new Date(o.created);case"created_asc":return new Date(o.created)-new Date(t.created);case"endsAt_desc":return new Date(t.endsAt)-new Date(o.endsAt);case"endsAt_asc":return new Date(o.endsAt)-new Date(t.endsAt);case"bids_desc":return(t._count?.bids||0)-(o._count?.bids||0);case"bids_asc":return(o._count?.bids||0)-(t._count?.bids||0);default:return 0}})}x();b();L();E();let g=1;const d=document.getElementById("sort-by");if(d){const e=d.value;l(g,e),d.addEventListener("change",()=>{const s=d.value;l(g,s)})}else console.error("Sort control not found");async function l(e=1,s="created_desc"){try{let{listings:t,totalCount:i}=await y(20,e);t&&Array.isArray(t)?(t=B(t,s),u(t),v(e,i,20,r=>{l(r,s)})):console.error("No listings data available")}catch(t){console.error("Error loading listings:",t)}}l(g);
